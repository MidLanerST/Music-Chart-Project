create table contributor
(
cont_id INT unsigned not null auto_increment,
cont_name varchar(200) not null,
PRIMARY KEY (cont_id)
);

insert into contributor (cont_name)
  select distinct writtenby1 from top100
    where writtenby1 is not null
UNION
  select writtenby2 from top100
    where writtenby2 is not null
UNION
  select writtenby3 from top100
    where writtenby3 is not null
UNION
  select writtenby4 from top100
    where writtenby4 is not null
UNION
  select writtenby5 from top100
    where writtenby5 is not null
UNION
  select writtenby6 from top100
    where writtenby6 is not null
UNION
  select writtenby7 from top100
    where writtenby7 is not null
UNION
  select writtenby8 from top100
    where writtenby8 is not null
UNION
  select artist from top100
     where artist is not null;


create table label
(
label_id INT unsigned not null auto_increment,
label_name varchar(30) not null,
PRIMARY KEY (label_id)
);

insert into label (label_name)
select distinct label from top100
where label is not null;

create table song
(
song_id INT unsigned not null auto_increment,
song_prefix char(10) not null,
song_title varchar(100) not null,
song_releaseyear char(4) not null,
song_dateentered date not null,
song_datepeaked date not null,
song_rankpeaked INT not null,
song_yearlyrank char(4) not null,
song_artist INT unsigned not null,
song_label INT unsigned not null,
PRIMARY KEY (song_id),
CONSTRAINT song_artistfk FOREIGN KEY (song_artist) REFERENCES contributor(cont_id),
CONSTRAINT song_labelfk FOREIGN KEY (song_label) REFERENCES label(label_id)
);

insert into song (song_prefix, song_title, song_releaseyear, song_dateentered, song_datepeaked, song_rankpeaked, song_yearlyrank, song_artist, song_label)
select prefix, tracktitle, year, dateentered, datepeaked, highest, yearlyrank, cont_id, label_id from top100, contributor, label
where
(top100.artist = contributor.cont_name) and
(top100.label = label.label_name);


create table rankingposition
(
rank_songid INT unsigned not null,
rank_week Int not null,
rank_date date not null,
rank_position INT not null,
PRIMARY KEY (rank_songid, rank_week),
CONSTRAINT rank_songfk FOREIGN KEY (rank_songid) REFERENCES song(song_id)
);

insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 1, song_dateentered, week1 from song, top100
where (week1 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 2, song_dateentered + interval (2-1)*7 day, week2 from song, top100
where (week2 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 3, song_dateentered + interval (3-1)*7 day, week3 from song, top100
where (week3 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 4, song_dateentered + interval (4-1)*7 day, week4 from song, top100
where (week4 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 5, song_dateentered + interval (5-1)*7 day, week5 from song, top100
where (week5 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 6, song_dateentered + interval (6-1)*7 day, week6 from song, top100
where (week6 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 7, song_dateentered + interval (7-1)*7 day, week7 from song, top100
where (week7 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 8, song_dateentered + interval (8-1)*7 day, week8 from song, top100
where (week8 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 9, song_dateentered + interval (9-1)*7 day, week9 from song, top100
where (week9 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 10, song_dateentered + interval (10-1)*7 day, week10 from song, top100
where (week10 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 11, song_dateentered + interval (11-1)*7 day, week11 from song, top100
where (week11 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 12, song_dateentered + interval (12-1)*7 day, week12 from song, top100
where (week12 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 13, song_dateentered + interval (13-1)*7 day, week13 from song, top100
where (week13 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 14, song_dateentered + interval (14-1)*7 day, week14 from song, top100
where (week14 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 15, song_dateentered + interval (15-1)*7 day, week15 from song, top100
where (week15 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 16, song_dateentered + interval (16-1)*7 day, week16 from song, top100
where (week16 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 17, song_dateentered + interval (17-1)*7 day, week17 from song, top100
where (week17 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 18, song_dateentered + interval (18-1)*7 day, week18 from song, top100
where (week18 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 19, song_dateentered + interval (19-1)*7 day, week19 from song, top100
where (week19 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 20, song_dateentered + interval (20-1)*7 day, week20 from song, top100
where (week20 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 21, song_dateentered + interval (21-1)*7 day, week21 from song, top100
where (week21 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 22, song_dateentered + interval (22-1)*7 day, week22 from song, top100
where (week22 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 23, song_dateentered + interval (23-1)*7 day, week23 from song, top100
where (week23 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 24, song_dateentered + interval (24-1)*7 day, week24 from song, top100
where (week24 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 25, song_dateentered + interval (25-1)*7 day, week25 from song, top100
where (week25 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 26, song_dateentered + interval (26-1)*7 day, week26 from song, top100
where (week26 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 27, song_dateentered + interval (27-1)*7 day, week27 from song, top100
where (week27 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 28, song_dateentered + interval (28-1)*7 day, week28 from song, top100
where (week28 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 29, song_dateentered + interval (29-1)*7 day, week29 from song, top100
where (week29 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 30, song_dateentered + interval (30-1)*7 day, week30 from song, top100
where (week30 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 31, song_dateentered + interval (31-1)*7 day, week31 from song, top100
where (week31 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 32, song_dateentered + interval (32-1)*7 day, week32 from song, top100
where (week32 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 33, song_dateentered + interval (33-1)*7 day, week33 from song, top100
where (week33 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 34, song_dateentered + interval (34-1)*7 day, week34 from song, top100
where (week34 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 35, song_dateentered + interval (35-1)*7 day, week35 from song, top100
where (week35 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 36, song_dateentered + interval (36-1)*7 day, week36 from song, top100
where (week36 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 37, song_dateentered + interval (37-1)*7 day, week37 from song, top100
where (week37 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 38, song_dateentered + interval (38-1)*7 day, week38 from song, top100
where (week38 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 39, song_dateentered + interval (39-1)*7 day, week39 from song, top100
where (week39 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 40, song_dateentered + interval (40-1)*7 day, week40 from song, top100
where (week40 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 41, song_dateentered + interval (41-1)*7 day, week41 from song, top100
where (week41 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 42, song_dateentered + interval (42-1)*7 day, week42 from song, top100
where (week42 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 43, song_dateentered + interval (43-1)*7 day, week43 from song, top100
where (week43 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 44, song_dateentered + interval (44-1)*7 day, week44 from song, top100
where (week44 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 45, song_dateentered + interval (45-1)*7 day, week45 from song, top100
where (week45 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 46, song_dateentered + interval (46-1)*7 day, week46 from song, top100
where (week46 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 47, song_dateentered + interval (47-1)*7 day, week47 from song, top100
where (week47 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 48, song_dateentered + interval (48-1)*7 day, week48 from song, top100
where (week48 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 49, song_dateentered + interval (49-1)*7 day, week49 from song, top100
where (week49 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 50, song_dateentered + interval (50-1)*7 day, week50 from song, top100
where (week50 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 51, song_dateentered + interval (51-1)*7 day, week51 from song, top100
where (week51 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 52, song_dateentered + interval (52-1)*7 day, week52 from song, top100
where (week52 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 53, song_dateentered + interval (53-1)*7 day, week53 from song, top100
where (week53 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 54, song_dateentered + interval (54-1)*7 day, week54 from song, top100
where (week54 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 55, song_dateentered + interval (55-1)*7 day, week55 from song, top100
where (week55 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 56, song_dateentered + interval (56-1)*7 day, week56 from song, top100
where (week56 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 57, song_dateentered + interval (57-1)*7 day, week57 from song, top100
where (week57 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 58, song_dateentered + interval (58-1)*7 day, week58 from song, top100
where (week58 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 59, song_dateentered + interval (59-1)*7 day, week59 from song, top100
where (week59 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 60, song_dateentered + interval (60-1)*7 day, week60 from song, top100
where (week60 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 61, song_dateentered + interval (61-1)*7 day, week61 from song, top100
where (week61 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 62, song_dateentered + interval (62-1)*7 day, week62 from song, top100
where (week62 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 63, song_dateentered + interval (63-1)*7 day, week63 from song, top100
where (week63 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 64, song_dateentered + interval (64-1)*7 day, week64 from song, top100
where (week64 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 65, song_dateentered + interval (65-1)*7 day, week65 from song, top100
where (week65 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 66, song_dateentered + interval (66-1)*7 day, week66 from song, top100
where (week66 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 67, song_dateentered + interval (67-1)*7 day, week67 from song, top100
where (week67 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 68, song_dateentered + interval (68-1)*7 day, week68 from song, top100
where (week68 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 69, song_dateentered + interval (69-1)*7 day, week69 from song, top100
where (week69 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 70, song_dateentered + interval (70-1)*7 day, week70 from song, top100
where (week70 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 71, song_dateentered + interval (71-1)*7 day, week71 from song, top100
where (week71 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 72, song_dateentered + interval (72-1)*7 day, week72 from song, top100
where (week72 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 73, song_dateentered + interval (73-1)*7 day, week73 from song, top100
where (week73 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 74, song_dateentered + interval (74-1)*7 day, week74 from song, top100
where (week74 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 75, song_dateentered + interval (75-1)*7 day, week75 from song, top100
where (week75 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);
insert into rankingposition (rank_songid,rank_week, rank_date, rank_position)
select song_id, 76, song_dateentered + interval (76-1)*7 day, week76 from song, top100
where (week76 > 0) and (song_title = tracktitle) and (song_releaseyear = year) and (song_yearlyrank = yearlyrank);


create table songwriter
(
write_songid INT unsigned not null,
write_contid INT unsigned not null,
write_order INT not null,
PRIMARY KEY (write_songid, write_order),
CONSTRAINT write_songfk FOREIGN KEY (write_songid) REFERENCES song(song_id),
CONSTRAINT write_fk FOREIGN KEY (write_contid) REFERENCES contributor(cont_id)
);

insert into songwriter (write_songid, write_contid, write_order)
select distinct song_id, cont_id, 1 from song, contributor, top100
where (song_releaseyear = year) and (song_yearlyrank = yearlyrank) and (writtenby1 is not null) and (writtenby1 <> '') and (writtenby1 = cont_name) and (song_title = tracktitle)
UNION
select distinct song_id, cont_id, 2 from song, contributor, top100
where (song_releaseyear = year) and (song_yearlyrank = yearlyrank) and (writtenby2 is not null) and (writtenby2 <> '') and (writtenby2 = cont_name) and (song_title = tracktitle)
UNION
select distinct song_id, cont_id, 3 from song, contributor, top100
where (song_releaseyear = year) and (song_yearlyrank = yearlyrank) and (writtenby3 is not null) and (writtenby3 <> '') and (writtenby3 = cont_name) and (song_title = tracktitle)
UNION
select distinct song_id, cont_id, 4 from song, contributor, top100
where (song_releaseyear = year) and (song_yearlyrank = yearlyrank) and (writtenby4 is not null) and (writtenby4 <> '') and (writtenby4 = cont_name) and (song_title = tracktitle)
UNION
select distinct song_id, cont_id, 5 from song, contributor, top100
where (song_releaseyear = year) and (song_yearlyrank = yearlyrank) and (writtenby5 is not null) and (writtenby5 <> '') and (writtenby5 = cont_name) and (song_title = tracktitle)
UNION
select distinct song_id, cont_id, 6 from song, contributor, top100
where (song_releaseyear = year) and (song_yearlyrank = yearlyrank) and (writtenby6 is not null) and (writtenby6 <> '') and (writtenby6 = cont_name) and (song_title = tracktitle)
UNION
select distinct song_id, cont_id, 7 from song, contributor, top100
where (song_releaseyear = year) and (song_yearlyrank = yearlyrank) and (writtenby7 is not null) and (writtenby7 <> '') and (writtenby7 = cont_name) and (song_title = tracktitle)
UNION
select distinct song_id, cont_id, 8 from song, contributor, top100
where (song_releaseyear = year) and (song_yearlyrank = yearlyrank) and (writtenby8 is not null) and (writtenby8 <> '') and (writtenby8 = cont_name) and (song_title = tracktitle);